<%- include('../partials/header', { title: 'Rate Your Service - Classic Cuts' }) %>

<main class="main-content">
    <div class="container">
        <div class="page-header">
            <h1 class="page-title">Rate Your Service</h1>
            <a href="/customer/dashboard" class="btn btn-outline">← Back to Dashboard</a>
        </div>

        <% if (appointment) { %>
            <div class="rating-container">
                <div class="rating-card">
                    <div class="rating-header">
                        <h2>How was your experience?</h2>
                        <p>Your feedback helps us improve our services</p>
                    </div>

                    <div class="appointment-summary">
                        <h3>Appointment Details</h3>
                        <div class="summary-grid">
                            <div class="summary-item">
                                <span class="label">Service:</span>
                                <span class="value"><%= appointment.service.name %></span>
                            </div>
                            <div class="summary-item">
                                <span class="label">Barber:</span>
                                <span class="value"><%= appointment.barber.name %></span>
                            </div>
                            <div class="summary-item">
                                <span class="label">Date:</span>
                                <span class="value">
                                    <%= moment(appointment.appointment_date).format('MMM D, YYYY') %>
                                </span>
                            </div>
                        </div>
                    </div>

                    <form action="/ratings/<%= appointment.id %>/rate" method="POST" class="rating-form">
                        <div class="form-group">
                            <label class="form-label">Overall Rating</label>
                            <div class="star-rating">
                                <input type="radio" id="star5" name="rating" value="5" required>
                                <label for="star5">★</label>
                                <input type="radio" id="star4" name="rating" value="4">
                                <label for="star4">★</label>
                                <input type="radio" id="star3" name="rating" value="3">
                                <label for="star3">★</label>
                                <input type="radio" id="star2" name="rating" value="2">
                                <label for="star2">★</label>
                                <input type="radio" id="star1" name="rating" value="1">
                                <label for="star1">★</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="review" class="form-label">
                                Your Review (Optional)
                            </label>
                            <textarea id="review" name="review" class="form-control" 
                                      placeholder="Tell us about your experience with <%= appointment.barber.name %>..."
                                      rows="4" maxlength="1000"></textarea>
                            <small class="form-help">Maximum 1000 characters</small>
                        </div>

                        <div class="form-actions">
                            <a href="/customer/dashboard" class="btn btn-outline">Cancel</a>
                            <button type="submit" class="btn btn-primary">Submit Rating</button>
                        </div>
                    </form>
                </div>
            </div>
        <% } else { %>
            <div class="empty-state">
                <div class="empty-icon">❌</div>
                <h3>Appointment Not Found</h3>
                <p>Unable to find the appointment to rate.</p>
                <a href="/customer/dashboard" class="btn btn-primary">Back to Dashboard</a>
            </div>
        <% } %>
    </div>
</main>

<style>
.star-rating {
    display: flex;
    flex-direction: row-reverse;
    justify-content: flex-end;
    gap: 5px;
}

.star-rating input {
    display: none;
}

.star-rating label {
    font-size: 2rem;
    color: #ddd;
    cursor: pointer;
    transition: color 0.2s;
}

.star-rating label:hover,
.star-rating label:hover ~ label,
.star-rating input:checked ~ label {
    color: #ffc107;
}
</style>

<%- include('../partials/footer') %>