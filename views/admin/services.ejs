<!-- Stats Cards -->
<div class="grid grid-4 gap-3 mb-4">
    <div class="card p-3 border-l-4 border-primary">
        <div class="flex justify-between items-center">
            <div>
                <div class="text-xs font-bold uppercase text-primary mb-1">Total Services</div>
                <div class="text-2xl font-bold text-primary">
                    <%= services.length %>
                </div>
            </div>
            <i class="fas fa-concierge-bell fa-2x text-primary opacity-50"></i>
        </div>
    </div>
    <div class="card p-3 border-l-4 border-success">
        <div class="flex justify-between items-center">
            <div>
                <div class="text-xs font-bold uppercase text-success mb-1">Active</div>
                <div class="text-2xl font-bold text-success">
                    <%= services.filter(s=> s.is_active).length %>
                </div>
            </div>
            <i class="fas fa-check-circle fa-2x text-success opacity-50"></i>
        </div>
    </div>
    <div class="card p-3 border-l-4 border-secondary">
        <div class="flex justify-between items-center">
            <div>
                <div class="text-xs font-bold uppercase text-secondary mb-1">Inactive</div>
                <div class="text-2xl font-bold text-secondary">
                    <%= services.filter(s=> !s.is_active).length %>
                </div>
            </div>
            <i class="fas fa-times-circle fa-2x text-secondary opacity-50"></i>
        </div>
    </div>
    <div class="card p-3 border-l-4 border-info">
        <div class="flex justify-between items-center">
            <div>
                <div class="text-xs font-bold uppercase text-info mb-1">Avg. Price</div>
                <div class="text-2xl font-bold text-info">
                    <% const activeServices=services.filter(s=> s.is_active);
                        const avgPrice = activeServices.length > 0
                        ? (activeServices.reduce((sum, service) => sum + parseFloat(service.price), 0) /
                        activeServices.length).toFixed(2)
                        : '0.00';
                        %>
                        $<%= avgPrice %>
                </div>
            </div>
            <i class="fas fa-dollar-sign fa-2x text-info opacity-50"></i>
        </div>
    </div>
</div>

<!-- Actions -->
<div class="card mb-4">
    <div class="card-body flex justify-between items-center">
        <h3 class="card-title mb-0">Services List</h3>
        <button class="btn btn-primary" onclick="openModal('newServiceModal')">
            <i class="fas fa-plus mr-2"></i> Add New Service
        </button>
    </div>
</div>

<!-- Services List -->
<div class="card">
    <div class="card-body p-0">
        <% if (services.length===0) { %>
            <div class="text-center py-5">
                <i class="fas fa-concierge-bell fa-3x text-muted mb-3"></i>
                <h4>No Services Found</h4>
                <p class="text-muted">There are no services in the system yet.</p>
            </div>
            <% } else { %>
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Service Name</th>
                                <th>Description</th>
                                <th>Price</th>
                                <th>Duration</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% services.forEach(service=> { %>
                                <tr>
                                    <td class="font-medium">
                                        <%= service.name %>
                                    </td>
                                    <td class="text-muted text-sm" style="max-width: 300px;">
                                        <%= service.description || 'No description' %>
                                    </td>
                                    <td class="font-bold text-gold">$<%= service.price %>
                                    </td>
                                    <td><span class="badge badge-neutral">
                                            <%= service.duration %> mins
                                        </span></td>
                                    <td>
                                        <span class="badge badge-<%= service.is_active ? 'success' : 'secondary' %>">
                                            <%= service.is_active ? 'Active' : 'Inactive' %>
                                        </span>
                                    </td>
                                    <td>
                                        <div class="flex gap-1">
                                            <button class="btn btn-sm btn-outline"
                                                onclick="toggleServiceStatus(<%= service.id %>, <%= !service.is_active %>)"
                                                title="<%= service.is_active ? 'Deactivate' : 'Activate' %>">
                                                <i class="fas fa-<%= service.is_active ? 'pause' : 'play' %>"></i>
                                            </button>
                                            <button class="btn btn-sm btn-primary"
                                                onclick="editService(<%= service.id %>)" title="Edit">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="btn btn-sm btn-danger"
                                                onclick="deleteService(<%= service.id %>)" title="Delete">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <% }); %>
                        </tbody>
                    </table>
                </div>
                <% } %>
    </div>
</div>

<!-- New Service Modal -->
<div id="newServiceModal" class="modal-overlay hidden"
    style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; display: flex; align-items: center; justify-content: center;">
    <div class="modal-content bg-primary p-4 rounded-lg shadow-lg" style="width: 100%; max-width: 500px;">
        <div class="flex justify-between items-center mb-4 border-b border-color pb-2">
            <h3 class="text-xl font-bold">Add New Service</h3>
            <button onclick="closeModal('newServiceModal')" class="text-muted hover:text-white"><i
                    class="fas fa-times"></i></button>
        </div>

        <form id="newServiceForm">
            <div class="form-group mb-3">
                <label class="form-label">Service Name *</label>
                <input type="text" class="form-control" name="name" required>
            </div>
            <div class="form-group mb-3">
                <label class="form-label">Description</label>
                <textarea class="form-control" name="description" rows="3"></textarea>
            </div>
            <div class="grid grid-2 gap-3 mb-3">
                <div class="form-group">
                    <label class="form-label">Price ($) *</label>
                    <input type="number" class="form-control" name="price" required min="0" step="0.01">
                </div>
                <div class="form-group">
                    <label class="form-label">Duration (mins) *</label>
                    <input type="number" class="form-control" name="duration" required min="5">
                </div>
            </div>
            <div class="form-group mb-4">
                <label class="form-label">Status</label>
                <select class="form-control" name="is_active">
                    <option value="true">Active</option>
                    <option value="false">Inactive</option>
                </select>
            </div>

            <div class="flex justify-end gap-2">
                <button type="button" class="btn btn-outline" onclick="closeModal('newServiceModal')">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="createService()">Add Service</button>
            </div>
        </form>
    </div>
</div>

<script>
    function openModal(id) {
        document.getElementById(id).classList.remove('hidden');
    }

    function closeModal(id) {
        document.getElementById(id).classList.add('hidden');
    }

    function toggleServiceStatus(id, isActive) {
        if (!confirm('Are you sure?')) return;
        alert('Status update functionality to be implemented');
    }

    function createService() {
        const form = document.getElementById('newServiceForm');
        if (!form.checkValidity()) {
            form.reportValidity();
            return;
        }
        alert('Create service functionality to be implemented');
        closeModal('newServiceModal');
    }

    function deleteService(id) {
        if (!confirm('Are you sure?')) return;
        alert('Delete functionality to be implemented');
    }

    function editService(id) {
        alert('Edit functionality to be implemented');
    }
</script>